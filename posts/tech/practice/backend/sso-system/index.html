<!doctype html><html lang=zh data-figures class=page><head><title>SSO相关设计 | LX 知识库</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta name=description content="SSO设计
一、 SSO 核心设计方案
单点登录（Single Sign-On，简称 SSO）的核心思想是“一次登录，处处通行”。用户只需在独立的身份提供商（IdP）登录一次，就可以访问所有相互信任的业务应用（SP），无需在每个应用中重复输入用户名和密码。"><meta name=twitter:card content="summary"><meta name=twitter:creator content><meta name=twitter:title content="SSO相关设计"><meta name=twitter:image content="https://namejlt.github.io/"><meta property="og:url" content="https://namejlt.github.io/posts/tech/practice/backend/sso-system/"><meta property="og:title" content="SSO相关设计"><meta property="og:description" content="SSO设计
一、 SSO 核心设计方案
单点登录（Single Sign-On，简称 SSO）的核心思想是“一次登录，处处通行”。用户只需在独立的身份提供商（IdP）登录一次，就可以访问所有相互信任的业务应用（SP），无需在每个应用中重复输入用户名和密码。"><meta property="og:image" content="https://namejlt.github.io/"><meta name=keywords content="系统设计"><link rel=apple-touch-icon sizes=180x180 href=https://namejlt.github.io/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://namejlt.github.io/icons/favicon-32x32.png><link rel=manifest href=https://namejlt.github.io/icons/site.webmanifest><link rel=canonical href=https://namejlt.github.io/posts/tech/practice/backend/sso-system/><link rel=preload href=https://namejlt.github.io/css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css integrity="sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" as=style crossorigin=anonymous><link rel=preload href=https://namejlt.github.io/zh/js/bundle.69325906ed33af5dc7368bca8e00939b95d01580847ca88772bf66270e14fb40adff431f178da9149d66c61d7dcb12f9db4aabf2273327b03c5ddfc5424b4d5e.js as=script integrity="sha512-aTJZBu0zr13HNovKjgCTm5XQFYCEfKiHcr9mJw4U+0Ct/0MfF42pFJ1mxh19yxL520qr8iczJ7A8Xd/FQktNXg==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://namejlt.github.io/css/styles.dc38388a8f0b890e788bd3a99b7495d14e7d5ac4359ed3b49abeb778497863b284ad4cc7e496ef58c84139295f9bafed82f5a41345eda86bd2d429cccb7c2596.css integrity="sha512-3Dg4io8LiQ54i9Opm3SV0U59WsQ1ntO0mr63eEl4Y7KErUzH5JbvWMhBOSlfm6/tgvWkE0XtqGvS1CnMy3wllg==" crossorigin=anonymous></head><body data-code=100 data-lines=false id=documentTop data-lang=zh><header class=nav_header><nav class=nav><a href=https://namejlt.github.io/ class="nav_brand nav_item" title="LX 知识库">LX 知识库<div class=nav_close><div><svg class="icon"><title>open-menu</title><use xlink:href="#open-menu"/></svg>
<svg class="icon"><title>closeme</title><use xlink:href="#closeme"/></svg></div></div></a><div class='nav_body nav_body_left'><div class=nav_parent><a href=https://namejlt.github.io/posts/ class=nav_item title=文章>文章</a></div><div class=nav_parent><a href=https://namejlt.github.io/tags/ class=nav_item title=标签>标签</a></div><div class=nav_parent><a href=https://namejlt.github.io/categories/ class=nav_item title=分类>分类</a></div><div class=nav_parent><a href=https://namejlt.github.io/about/ class=nav_item title=关于>关于</a></div><div class=follow><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title>SSO相关设计</h1><div class=post_meta><span><svg class="icon"><title>calendar</title><use xlink:href="#calendar"/></svg>
</span><span class=post_date>Aug 18, 2025
</span><span class=post_time>· 13 分钟阅读</span><span>&nbsp;· <a href=https://namejlt.github.io/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/ title=系统设计 class="post_tag button button_translucent">系统设计
</a></span><span class=page_only>&nbsp;·<div class=post_share>分享到:
<a href="https://twitter.com/intent/tweet?text=SSO%e7%9b%b8%e5%85%b3%e8%ae%be%e8%ae%a1&url=https%3a%2f%2fnamejlt.github.io%2fposts%2ftech%2fpractice%2fbackend%2fsso-system%2f&tw_p=tweetbutton" class=twitter title="分享到 Twitter" target=_blank rel=nofollow><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg>
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fnamejlt.github.io%2fposts%2ftech%2fpractice%2fbackend%2fsso-system%2f&t=SSO%e7%9b%b8%e5%85%b3%e8%ae%be%e8%ae%a1" class=facebook title="分享到 Facebook" target=_blank rel=nofollow><svg class="icon"><title>facebook</title><use xlink:href="#facebook"/></svg>
</a><a href=#linkedinshare id=linkedinshare class=linkedin title="分享到 LinkedIn" rel=nofollow><svg class="icon"><title>linkedin</title><use xlink:href="#linkedin"/></svg>
</a><a href=https://namejlt.github.io/posts/tech/practice/backend/sso-system/ title="Copy Link" class="link link_yank"><svg class="icon"><title>copy</title><use xlink:href="#copy"/></svg></a></div></span></div><div class=post_toc><h2>文章目录</h2><nav id=TableOfContents><ul><li><a href=#sso设计>SSO设计</a><ul><li><a href=#一-sso-核心设计方案>一、 SSO 核心设计方案</a></li><li><a href=#二-sso-最佳实践标准>二、 SSO 最佳实践标准</a></li><li><a href=#三-sso-与-oauth2-的关系与区别>三、 SSO 与 OAuth2 的关系与区别</a></li><li><a href=#四-jwt-在-sso-中的作用>四、 JWT 在 SSO 中的作用</a></li><li><a href=#五-业务应用需要自己管理密钥吗>五、 业务应用需要自己管理密钥吗？</a></li><li><a href=#六-全局登录态与jwt时效性保障>六、 全局登录态与JWT时效性保障</a></li><li><a href=#七-sso系统设计中的常见问题与解决方案>七、 SSO系统设计中的常见问题与解决方案</a></li></ul></li></ul></nav></div><div class=post_body><h2 id=sso设计>SSO设计</h2><h3 id=一-sso-核心设计方案>一、 SSO 核心设计方案</h3><p>单点登录（Single Sign-On，简称 SSO）的核心思想是“一次登录，处处通行”。用户只需在独立的身份提供商（IdP）登录一次，就可以访问所有相互信任的业务应用（SP），无需在每个应用中重复输入用户名和密码。</p><h4 id=1-核心组件>1. 核心组件</h4><p>一个典型的 SSO 系统包含以下三个核心角色：</p><ul><li><strong>用户 (User)</strong>：希望访问多个应用的最终用户。</li><li><strong>身份提供商 (Identity Provider, IdP)</strong>：负责验证用户身份、维护全局登录状态，并向业务应用提供用户身份信息的服务。通常被称为“SSO认证中心”。</li><li><strong>服务提供商 (Service Provider, SP)</strong>：指用户的目标业务应用，它信任 IdP 提供的身份信息。</li></ul><h4 id=2-架构图>2. 架构图</h4><pre tabindex=0><code class=language-mermaid data-lang=mermaid>sequenceDiagram
    participant User as 用户
    participant SP as 业务应用 (SP)
    participant IdP as 认证中心 (IdP)

    User-&gt;&gt;+SP: 1. 访问受保护资源
    SP--&gt;&gt;User: 2. 发现未登录, 重定向至IdP (携带回调地址)
    User-&gt;&gt;+IdP: 3. 访问IdP登录页面
    IdP--&gt;&gt;User: 4. 要求输入凭证
    User-&gt;&gt;IdP: 5. 提交用户名和密码
    IdP-&gt;&gt;IdP: 6. 验证凭证, 创建全局会话
    IdP--&gt;&gt;-User: 7. 生成授权凭证(如code), 重定向回SP回调地址
    User-&gt;&gt;+SP: 8. 携带授权凭证访问SP回调地址
    SP-&gt;&gt;+IdP: 9. 后端验证授权凭证 (拿code换token)
    IdP--&gt;&gt;-SP: 10. 验证通过, 返回JWT(包含用户信息)
    SP-&gt;&gt;SP: 11. 解析JWT, 创建本地会话
    SP--&gt;&gt;-User: 12. 登录成功, 返回受保护资源
</code></pre><h4 id=3-详细流程>3. 详细流程</h4><p><strong>登录流程 (Login Flow):</strong></p><ol><li><strong>用户访问SP</strong>：用户首次访问业务应用（SP）的某个受保护页面。</li><li><strong>SP检查会话</strong>：SP检查本地是否存在用户的会话。如果不存在，说明用户未登录。</li><li><strong>重定向至IdP</strong>：SP将用户的浏览器重定向到IdP的登录页面。重定向时，通常会携带一个<code>redirect_uri</code>参数，告知IdP在认证成功后应该跳回哪个地址。</li><li><strong>用户在IdP登录</strong>：<ul><li>如果用户在IdP上也没有登录，IdP会展示登录页面，要求用户输入凭证（如用户名密码、二次验证码等）。</li><li>如果用户已在IdP登录过（即存在全局会话），IdP会跳过此步骤。</li></ul></li><li><strong>IdP认证与授权</strong>：IdP验证用户凭证。成功后，IdP会创建一个全局会话（通常通过在IdP域名下设置Cookie实现），并生成一个短暂的授权凭证（例如Authorization Code）。</li><li><strong>IdP重定向回SP</strong>：IdP将用户的浏览器重定向回第3步中SP提供的<code>redirect_uri</code>，并附上授权凭证。</li><li><strong>SP获取访问令牌</strong>：SP的后端服务收到前端带来的授权凭证后，向IdP发起一个后端请求，用该凭证换取一个正式的身份令牌（通常是JWT）。</li><li><strong>SP创建本地会话</strong>：SP验证收到的JWT的签名和内容，验证通过后，认为用户合法。SP为用户创建本地会話（例如，将JWT返回给前端存储），并授权用户访问其资源。</li></ol><p><strong>登出流程 (Logout Flow / Single Log-Out, SLO):</strong></p><ol><li><strong>用户在SP登出</strong>：用户在某个业务应用（SP1）上点击“登出”。</li><li><strong>SP销毁本地会话</strong>：SP1销毁自己的本地会话，并重定向用户到IdP的登出接口。</li><li><strong>IdP销毁全局会话</strong>：IdP接收到登出请求，销毁用户的全局会话（清除Cookie）。</li><li><strong>IdP通知所有SP</strong>：IdP查询该用户登录过的所有SP列表，并通过后端请求或前端重定向的方式，逐个通知这些SP执行登出操作。每个SP接收到通知后，销毁各自的本地会话。这是SLO中最复杂的一环。</li></ol><h4 id=4-标准协议详解-以-openid-connect-授权码流程为例>4. 标准协议详解 (以 OpenID Connect 授权码流程为例)</h4><p>OpenID Connect (OIDC) 是构建在 OAuth 2.0 之上的身份认证层，是现代SSO最主流的实现标准。其核心流程“授权码流程” (Authorization Code Flow) 如下：</p><p><strong>第1步：发起授权请求 (SP -> IdP)</strong></p><p>SP通过浏览器重定向，将用户引导至IdP的授权端点 (<code>/authorize</code>)。</p><ul><li><strong>请求方法</strong>: <code>GET</code></li><li><strong>示例URL</strong>: <code>https://idp.com/authorize?response_type=code&amp;scope=openid%20profile&amp;client_id=sp_client_id&amp;state=xyz&amp;redirect_uri=https://sp.com/callback</code></li><li><strong>核心请求参数 (Query Parameters)</strong>:</li></ul><table><thead><tr><th style=text-align:left>参数</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left><code>response_type</code></td><td style=text-align:left><strong>必须</strong>为 <code>code</code>。表示使用授权码流程。</td></tr><tr><td style=text-align:left><code>client_id</code></td><td style=text-align:left><strong>必须</strong>。SP在IdP注册时获得的客户端ID。</td></tr><tr><td style=text-align:left><code>redirect_uri</code></td><td style=text-align:left><strong>必须</strong>。IdP完成授权后重定向回SP的URL，必须与在IdP注册的回调地址完全一致。</td></tr><tr><td style=text-align:left><code>scope</code></td><td style=text-align:left><strong>必须</strong>包含 <code>openid</code>。可包含其他scope（如<code>profile</code>, <code>email</code>）来请求额外用户信息。</td></tr><tr><td style=text-align:left><code>state</code></td><td style=text-align:left><strong>强烈推荐</strong>。一个由SP生成的随机字符串，用于防止CSRF攻击。IdP会原样返回此参数。</td></tr><tr><td style=text-align:left><code>nonce</code></td><td style=text-align:left><strong>推荐</strong>。一个由SP生成的随机字符串，用于防止重放攻击，会包含在最终的<code>id_token</code>中。</td></tr></tbody></table><p><strong>第2步：获取授权码 (IdP -> SP)</strong></p><p>用户在IdP完成登录和授权后，IdP将用户重定向回SP的<code>redirect_uri</code>。</p><ul><li><strong>请求方法</strong>: <code>GET</code> (浏览器重定向)</li><li><strong>示例URL</strong>: <code>https://sp.com/callback?code=some_authorization_code&amp;state=xyz</code></li><li><strong>核心返回参数 (Query Parameters)</strong>:</li></ul><table><thead><tr><th style=text-align:left>参数</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left><code>code</code></td><td style=text-align:left>IdP生成的、一次性有效的授权码，生命周期很短（通常为1-10分钟）。</td></tr><tr><td style=text-align:left><code>state</code></td><td style=text-align:left>IdP原样返回SP在第一步中传递的<code>state</code>值。SP必须验证此值以确保请求的完整性。</td></tr></tbody></table><p><strong>第3步：用授权码交换令牌 (SP Backend -> IdP)</strong></p><p>SP的后端服务收到<code>code</code>后，立即向IdP的令牌端点 (<code>/token</code>) 发起一个<strong>后端HTTP请求</strong>。</p><ul><li><strong>请求方法</strong>: <code>POST</code></li><li><strong>Content-Type</strong>: <code>application/x-www-form-urlencoded</code></li><li><strong>核心请求参数 (Request Body)</strong>:</li></ul><table><thead><tr><th style=text-align:left>参数</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left><code>grant_type</code></td><td style=text-align:left><strong>必须</strong>为 <code>authorization_code</code>。</td></tr><tr><td style=text-align:left><code>code</code></td><td style=text-align:left><strong>必须</strong>。上一步中获取的授权码。</td></tr><tr><td style=text-align:left><code>redirect_uri</code></td><td style=text-align:left><strong>必须</strong>。与第一步中发送的<code>redirect_uri</code>完全相同。</td></tr><tr><td style=text-align:left><code>client_id</code></td><td style=text-align:left><strong>必须</strong>。SP的客户端ID。</td></tr><tr><td style=text-align:left><code>client_secret</code></td><td style=text-align:left><strong>必须</strong>。SP的客户端密钥，用于验证SP自身的身份。<strong>此参数的存在决定了该请求必须在后端发起</strong>。</td></tr></tbody></table><p><strong>第4步：接收并解析令牌 (IdP -> SP Backend)</strong></p><p>IdP验证授权码和客户端密钥无误后，返回一个JSON对象，其中包含核心的<code>id_token</code>和<code>access_token</code>。</p><ul><li><strong>核心返回数据 (JSON Response Body)</strong>:</li></ul><table><thead><tr><th style=text-align:left>参数</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left><code>access_token</code></td><td style=text-align:left>OAuth 2.0的访问令牌，可用于请求IdP的用户信息端点 (<code>/userinfo</code>)。</td></tr><tr><td style=text-align:left><code>token_type</code></td><td style=text-align:left>通常为 <code>Bearer</code>。</td></tr><tr><td style=text-align:left><code>expires_in</code></td><td style=text-align:left><code>access_token</code>的有效期（秒）。</td></tr><tr><td style=text-align:left><code>refresh_token</code></td><td style=text-align:left>(可选) 用于在<code>access_token</code>过期后，无需用户交互即可获取新的<code>access_token</code>。</td></tr><tr><td style=text-align:left><code>id_token</code></td><td style=text-align:left><strong>OIDC的核心</strong>。一个JWT格式的字符串，包含了用户的身份信息。</td></tr></tbody></table><p><strong>第5步：验证 <code>id_token</code> 并创建本地会话</strong></p><p>SP的后端拿到<code>id_token</code>后，<strong>必须</strong>执行以下校验：</p><ol><li><strong>解析JWT</strong>：分离出Header, Payload, Signature。</li><li><strong>验证签名</strong>：使用IdP的公钥验证JWT的签名是否有效。</li><li><strong>验证Claims (声明)</strong>：<ul><li>验证<code>iss</code> (Issuer) 是否为IdP的地址。</li><li>验证<code>aud</code> (Audience) 是否包含自身的<code>client_id</code>。</li><li>验证<code>exp</code> (Expiration Time) 是否晚于当前时间。</li><li>验证<code>nonce</code>是否与第一步中发送的<code>nonce</code>一致。</li></ul></li></ol><p>所有验证通过后，SP便可信任<code>id_token</code>中的用户信息（如<code>sub</code>字段，即用户唯一标识），并为该用户创建自己的本地登录会话。</p><hr><h3 id=二-sso-最佳实践标准>二、 SSO 最佳实践标准</h3><ol><li><strong>强制使用HTTPS</strong>：所有IdP和SP之间的通信，包括前端重定向和后端API调用，都必须使用HTTPS，防止凭证和令牌在传输过程中被窃取。</li><li><strong>使用标准协议</strong>：优先采用成熟的SSO协议，如 <strong>OAuth 2.0 + OpenID Connect (OIDC)</strong> 或 <strong>SAML 2.0</strong>。这能确保安全性和互操作性，避免自研协议带来的安全漏洞。</li><li><strong>保护IdP</strong>：IdP是整个系统的安全核心，必须采取最高级别的安全防护，包括防范DDoS攻击、暴力破解、SQL注入等。同时，IdP应支持多因素认证（MFA）以增强账户安全。</li><li><strong>短生命周期的访问令牌</strong>：业务应用使用的访问令牌（JWT）应设置较短的有效期（如15-60分钟），以降低令牌泄露后的风险。</li><li><strong>使用刷新令牌（Refresh Token）</strong>：配合短生命周期的访问令牌，为客户端提供刷新令牌。刷新令牌的有效期可以更长（如数天或数周），并存储在安全的地方（如HttpOnly的Cookie中），用于在访问令牌过期后静默获取新的访问令牌，提升用户体验。</li><li><strong>安全的Cookie策略</strong>：设置在IdP和SP域名下的Cookie应使用<code>HttpOnly</code>、<code>Secure</code>和<code>SameSite=Lax</code>或<code>Strict</code>属性，防止XSS攻击和CSRF攻击。</li><li><strong>实现可靠的单点登出 (SLO)</strong>：SLO实现复杂，但至关重要。可以采用后端通知机制，并为SP提供一个主动校验令牌有效性的接口，作为SLO通知失败时的补充。</li></ol><hr><h3 id=三-sso-与-oauth2-的关系与区别>三、 SSO 与 OAuth2 的关系与区别</h3><p>这是两个经常被混淆但本质不同的概念。</p><ul><li><p><strong>核心区别</strong>：</p><ul><li><strong>SSO (单点登录)</strong>：一个关于 <strong>认证 (Authentication)</strong> 的解决方案。它的核心目标是解决“用户是谁”的问题，让用户登录一次即可访问多个应用。</li><li><strong>OAuth 2.0 (开放授权)</strong>：一个关于 <strong>授权 (Authorization)</strong> 的协议。它的核心目标是解决“应用可以做什么”的问题，允许用户授权第三方应用访问其在某个服务上的特定资源，而无需共享密码。例如，“允许XX应用访问你的微信头像和昵称”。</li></ul></li><li><p><strong>关系</strong>：</p><ul><li><strong>SSO可以基于OAuth 2.0实现</strong>。现代SSO系统广泛使用 <strong>OpenID Connect (OIDC)</strong> 协议，而OIDC正是构建在OAuth 2.0之上的一个身份认证层。</li><li>在OIDC流程中，OAuth 2.0负责处理授权流程（如用户同意授权、颁发<code>access_token</code>），而OIDC在其之上增加了<code>id_token</code>（一个JWT），专门用于传递用户的身份信息，从而实现了SSO。</li><li>简单来说：<strong>OAuth 2.0 是授权框架，OIDC + OAuth 2.0 = 认证 + 授权 = 现代SSO解决方案</strong>。</li></ul></li></ul><hr><h3 id=四-jwt-在-sso-中的作用>四、 JWT 在 SSO 中的作用</h3><p>JWT (JSON Web Token) 在现代SSO（特别是基于OIDC的方案）中扮演着至关重要的角色，它是一种 <strong>安全、紧凑、自包含</strong> 的信息载体。</p><ol><li><p><strong>身份凭证 (Identity Token)</strong>：</p><ul><li>当IdP成功认证用户后，会生成一个包含用户身份信息的JWT（在OIDC中称为<code>id_token</code>）。</li><li>这个JWT包含了用户的基本信息，如用户ID (<code>sub</code>)、签发者 (<code>iss</code>)、受众 (<code>aud</code>)、过期时间 (<code>exp</code>) 等。还可以包含自定义的<code>claims</code>，如用户名、角色、部门等。</li></ul></li><li><p><strong>无状态验证</strong>：</p><ul><li>SP收到JWT后，只需验证其签名即可信任其中的信息。由于JWT是自包含的，SP的后端API在收到后续请求时，可以直接从JWT中获取用户信息，而<strong>无需每次都向IdP发起查询</strong>。这极大地降低了IdP的压力，并提升了系统性能。</li></ul></li><li><p><strong>防篡改</strong>：</p><ul><li>JWT由三部分组成：Header、Payload、Signature。Signature是使用IdP的私钥对前两部分进行签名的结果。</li><li>任何一方如果试图修改Payload中的内容（如将普通用户角色改为管理员），由于没有IdP的私钥，无法生成有效的签名。SP在验证签名时会发现不匹配，从而拒绝该令牌，保证了信息的完整性和真实性。</li></ul></li></ol><hr><h3 id=五-业务应用需要自己管理密钥吗>五、 业务应用需要自己管理密钥吗？</h3><p>这个问题的答案需要分两个层面来看：<strong>对于IdP的信任验证</strong> 和 <strong>对于自身应用的会话管理</strong>。</p><h4 id=层面一验证idp令牌时sp不管理密钥>层面一：验证IdP令牌时，SP不管理密钥</h4><p>在SSO流程中，当SP需要验证从IdP收到的身份令牌（<code>id_token</code>）时，它扮演的是<strong>验证方</strong>角色。此时，遵循<strong>信任中心化</strong>原则：</p><ul><li><strong>密钥管理模型</strong>：采用非对称加密。<ul><li><strong>IdP (认证中心)</strong>：持有<strong>私钥</strong>，用于对JWT进行签名。这是信任的根源。</li><li><strong>SP (业务应用)</strong>：持有IdP的<strong>公钥</strong>，用于验证JWT签名的有效性。</li></ul></li></ul><p>在这个层面，SP<strong>绝对不能，也不需要</strong>管理自己的密钥。它只需安全地获取并缓存IdP的公钥即可。IdP通常会通过一个公开的URL端点（如<code>.well-known/jwks.json</code>）来分发其公钥。</p><h4 id=层面二sp生成内部会话令牌时需要自己管理密钥>层面二：SP生成内部会话令牌时，需要自己管理密钥</h4><p>当SP验证IdP的令牌成功、确认用户身份后，通常会<strong>生成一个属于SP自己的JWT</strong>，用于在SP自身的前后端或微服务之间传递用户信息和权限。</p><p><strong>此时，SP必须使用自己独立的密钥来签发和验证这个内部JWT。</strong></p><ul><li><p><strong>为何必须如此</strong>：</p><ol><li><strong>关注点分离</strong>：IdP的JWT用于<strong>跨系统身份认证</strong>，而SP的内部JWT用于<strong>应用内会话管理和授权</strong>。后者可能包含更多应用专属信息（如应用角色、权限ID），这些信息IdP不应也无需关心。</li><li><strong>安全风险隔离</strong>：IdP的私钥是SSO体系的最高机密。SP使用独立的密钥，意味着即便SP的密钥泄露，也<strong>仅危及自身应用</strong>，不会影响到整个SSO体系和其他SP的安全。这是至关重要的安全设计。</li><li><strong>自主与灵活</strong>：SP可以独立管理其内部JWT的生命周期和内容，当用户权限变更时，可自行签发新令牌，无需与IdP交互。</li></ol></li><li><p><strong>SP的密钥类型选择</strong>：</p><ul><li><strong>对称密钥 (Symmetric Key)</strong>：如果SP后端是单体应用，或前后端紧密耦合，使用一个高熵的共享密钥（Secret）通过<strong>HMAC</strong>算法签名即可，简单高效。</li><li><strong>非对称密钥 (Asymmetric Keys)</strong>：如果SP自身是微服务架构，可由其内部的“认证服务”使用私钥签发令牌，其他业务服务使用公钥验签，实现内部的信任传递。</li></ul></li></ul><p><strong>总结</strong>：</p><table><thead><tr><th style=text-align:left>场景</th><th style=text-align:left>涉及的JWT</th><th style=text-align:left>SP的角色</th><th style=text-align:left>是否管理密钥</th><th style=text-align:left>密钥类型</th></tr></thead><tbody><tr><td style=text-align:left><strong>跨系统身份认证</strong></td><td style=text-align:left>IdP签发的<code>id_token</code></td><td style=text-align:left>验证方</td><td style=text-align:left><strong>否</strong> (只需获取IdP公钥)</td><td style=text-align:left>IdP的非对称密钥对</td></tr><tr><td style=text-align:left><strong>应用内部会话管理</strong></td><td style=text-align:left>SP自己签发的<code>app_token</code></td><td style=text-align:left>签发与验证方</td><td style=text-align:left><strong>是</strong> (必须独立管理)</td><td style=text-align:left>对称或非对称密钥</td></tr></tbody></table><hr><h3 id=六-全局登录态与jwt时效性保障>六、 全局登录态与JWT时效性保障</h3><p>这是一个关于用户体验和安全性平衡的关键问题。</p><ul><li><p><strong>全局登录态 (IdP Session)</strong>：</p><ul><li><strong>载体</strong>：通常是IdP域名下的一个安全Cookie。</li><li><strong>时效性</strong>：<strong>长周期</strong>（例如8小时、1天或更长）。这决定了用户在多长时间内无需重新输入密码即可在不同应用间穿梭。</li><li><strong>管理</strong>：由IdP统一管理。用户在IdP上的任何活动都可以刷新这个会话的过期时间。</li></ul></li><li><p><strong>业务应用JWT (Access Token)</strong>：</p><ul><li><strong>载体</strong>：由IdP签发，SP使用和验证的令牌。</li><li><strong>时效性</strong>：<strong>短周期</strong>（例如15分钟、1小时）。目的是为了降低JWT泄露后被恶意利用的风险。</li><li><strong>管理</strong>：由SP的客户端（如浏览器）存储，并在每次API请求时携带。</li></ul></li><li><p><strong>如何协同工作（静默刷新机制）</strong>：</p><ol><li>用户的应用JWT过期了。</li><li>SP的客户端检测到JWT过期（例如API返回401错误）。</li><li>客户端<strong>不会立即让用户重新登录</strong>，而是通过一个隐藏的iframe或重定向，静默地访问IdP的授权端点。</li><li>因为用户的浏览器中还存有IdP的<strong>有效全局会话Cookie</strong>，IdP识别出用户是已登录状态。</li><li>IdP无需用户交互，直接生成一个新的授权凭证（code），并重定向回SP。</li><li>SP用新的code换取一个新的、短时效的JWT。</li><li>整个过程对用户透明，用户感觉自己一直处于登录状态。只有当IdP的全局会话也过期时，用户才需要重新输入密码。</li></ol></li></ul><p>这个机制完美地平衡了安全（JWT生命周期短）和用户体验（用户无需频繁登录）。</p><hr><h3 id=七-sso系统设计中的常见问题与解决方案>七、 SSO系统设计中的常见问题与解决方案</h3><ol><li><p><strong>问题：单点故障 (Single Point of Failure)</strong></p><ul><li><strong>描述</strong>：IdP成为整个系统的核心，一旦IdP宕机，所有应用的登录功能都会瘫痪。</li><li><strong>解决方案</strong>：<ul><li><strong>高可用部署</strong>：对IdP服务进行集群化部署，使用负载均衡器分发流量。</li><li><strong>异地多活/灾备</strong>：在不同地理位置部署IdP实例，当一个数据中心出现问题时，可以快速切换到备用中心。</li><li><strong>数据同步</strong>：确保会话数据、用户数据在多个IdP实例之间实时同步。</li></ul></li></ul></li><li><p><strong>问题：单点登出 (SLO) 的复杂性与不可靠性</strong></p><ul><li><strong>描述</strong>：通知所有SP登出的过程可能因为网络问题或某个SP宕机而失败，导致部分应用未成功登出。</li><li><strong>解决方案</strong>：<ul><li><strong>后端通知与前端引导结合</strong>：IdP后端尝试通知所有SP，同时前端可以嵌入多个隐藏的iframe来请求各个SP的登出接口。</li><li><strong>令牌有效性校验接口</strong>：SP应定期（或在执行敏感操作前）调用IdP的接口来校验当前JWT是否依然有效。如果IdP已将用户登出，该校验会失败，SP即可销毁本地会话。这是一种可靠的补偿机制。</li><li><strong>接受最终一致性</strong>：在某些场景下，可以接受登出状态的短暂不一致。</li></ul></li></ul></li><li><p><strong>问题：令牌安全与泄露风险</strong></p><ul><li><strong>描述</strong>：JWT如果被截获，攻击者可以在其有效期内冒充用户。</li><li><strong>解决方案</strong>：<ul><li><strong>强制HTTPS</strong>：从根源上防止中间人攻击。</li><li><strong>缩短JWT有效期</strong>：将风险窗口降到最低。</li><li><strong>令牌吊销列表 (Token Revocation List)</strong>：IdP可以维护一个已吊销令牌的列表。SP在校验令牌时，除了验证签名，还需查询该列表。但这会增加IdP的负担，破坏JWT无状态的优点，需谨慎使用。</li><li><strong>安全存储</strong>：在浏览器端，将刷新令牌等敏感信息存储在<code>HttpOnly</code>的Cookie中，防止被JavaScript脚本窃取。</li></ul></li></ul></li><li><p><strong>问题：跨域问题 (CORS)</strong></p><ul><li><strong>描述</strong>：IdP和多个SP通常部署在不同域名下，前端JavaScript交互会遇到跨域限制。</li><li><strong>解决方案</strong>：<ul><li><strong>IdP配置CORS策略</strong>：在IdP服务器上设置CORS响应头，明确允许来自SP域名的跨域请求。</li><li><strong>JSONP（不推荐）</strong>：老旧且不安全的方案，应避免使用。</li><li><strong>代理</strong>：在SP的后端设置一个代理接口，由后端代替前端与IdP通信，避免浏览器跨域。</li></ul></li></ul></li></ol></div><div class=post_comments></div></article><aside class=sidebar><section class=sidebar_inner><br><h2 class=mt-4>精选文章</h2><ul><li><a href=https://namejlt.github.io/posts/reading/note/book/learn-ask/ class=nav-link title=从“学会提问”掌握批判性思维>从“学会提问”掌握批判性思维</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/backend/payment-service/ class=nav-link title=支付系统设计>支付系统设计</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/backend/i18n-system/ class=nav-link title=通用多语言（i18n）服务设计>通用多语言（i18n）服务设计</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/backend/backend-summary/ class=nav-link title=后端常用技术总结>后端常用技术总结</a></li></ul><h2 class=mt-4>最新文章</h2><ul class=flex-column><li><a href=https://namejlt.github.io/posts/tech/practice/devops/canary-release/ class=nav-link title=灰度发布实践>灰度发布实践</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/devops/devops-system/ class=nav-link title=研发效能工程实践>研发效能工程实践</a></li><li><a href=https://namejlt.github.io/posts/reading/note/book/to-be-stronger/ class=nav-link title=从普通变得厉害>从普通变得厉害</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/design/group-room-system/ class=nav-link title=大型群聊系统设计>大型群聊系统设计</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/design/order-system/ class=nav-link title=订单系统设计>订单系统设计</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/design/comment-system/ class=nav-link title=评论系统设计>评论系统设计</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/backend/bigdata-story/ class=nav-link title=大数据技术演进>大数据技术演进</a></li><li><a href=https://namejlt.github.io/posts/tech/practice/design/security-system/ class=nav-link title=股票证券系统设计>股票证券系统设计</a></li></ul><div><h2 class="mt-4 taxonomy" id=categories-section>分类</h2><nav class=tags_nav><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/%E5%AE%9E%E8%B7%B5/%E5%90%8E%E7%AB%AF/ class="post_tag button button_translucent" title=技术/实践/后端>技术/实践/后端
<span class=button_tally>11</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/%E5%AE%9E%E8%B7%B5/%E8%AE%BE%E8%AE%A1/ class="post_tag button button_translucent" title=技术/实践/设计>技术/实践/设计
<span class=button_tally>5</span>
</a><a href=https://namejlt.github.io/categories/%E9%98%85%E8%AF%BB/%E7%AC%94%E8%AE%B0/%E9%97%AE%E9%A2%98/ class="post_tag button button_translucent" title=阅读/笔记/问题>阅读/笔记/问题
<span class=button_tally>5</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/ai/%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/ class="post_tag button button_translucent" title=技术/ai/应用开发>技术/AI/应用开发
<span class=button_tally>4</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/deepwiki/ class="post_tag button button_translucent" title=技术/源码阅读/deepwiki>技术/源码阅读/DEEPWIKI
<span class=button_tally>4</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/ai/%E7%AC%94%E8%AE%B0/ class="post_tag button button_translucent" title=技术/ai/笔记>技术/AI/笔记
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/golang/%E5%BC%80%E5%8F%91/ class="post_tag button button_translucent" title=技术/golang/开发>技术/GOLANG/开发
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/%E5%AE%9E%E8%B7%B5/%E7%A0%94%E5%8F%91%E6%95%88%E8%83%BD/ class="post_tag button button_translucent" title=技术/实践/研发效能>技术/实践/研发效能
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/categories/%E7%94%9F%E6%B4%BB/%E6%8A%80%E8%83%BD/%E6%B2%9F%E9%80%9A/ class="post_tag button button_translucent" title=生活/技能/沟通>生活/技能/沟通
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/categories/%E9%98%85%E8%AF%BB/%E7%AC%94%E8%AE%B0/%E5%9B%BE%E4%B9%A6/ class="post_tag button button_translucent" title=阅读/笔记/图书>阅读/笔记/图书
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/golang/%E5%9F%BA%E7%A1%80/ class="post_tag button button_translucent" title=技术/golang/基础>技术/GOLANG/基础
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/java/%E5%9F%BA%E7%A1%80/ class="post_tag button button_translucent" title=技术/java/基础>技术/JAVA/基础
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/categories/%E6%8A%80%E6%9C%AF/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/hugo/ class="post_tag button button_translucent" title=技术/源码阅读/hugo>技术/源码阅读/HUGO
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/categories/%E7%94%9F%E6%B4%BB/%E6%8A%80%E8%83%BD/%E9%80%BB%E8%BE%91/ class="post_tag button button_translucent" title=生活/技能/逻辑>生活/技能/逻辑
<span class=button_tally>1</span></a></nav></div><div><h2 class="mt-4 taxonomy" id=tags-section>标签</h2><nav class=tags_nav><a href=https://namejlt.github.io/tags/ai/ class="post_tag button button_translucent" title=ai>AI
<span class=button_tally>7</span>
</a><a href=https://namejlt.github.io/tags/golang/ class="post_tag button button_translucent" title=golang>GOLANG
<span class=button_tally>7</span>
</a><a href=https://namejlt.github.io/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B/ class="post_tag button button_translucent" title=大模型>大模型
<span class=button_tally>5</span>
</a><a href=https://namejlt.github.io/tags/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/ class="post_tag button button_translucent" title=源码阅读>源码阅读
<span class=button_tally>5</span>
</a><a href=https://namejlt.github.io/tags/%E8%AE%BE%E8%AE%A1/ class="post_tag button button_translucent" title=设计>设计
<span class=button_tally>5</span>
</a><a href=https://namejlt.github.io/tags/deepwiki/ class="post_tag button button_translucent" title=deepwiki>DEEPWIKI
<span class=button_tally>4</span>
</a><a href=https://namejlt.github.io/tags/%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/ class="post_tag button button_translucent" title=应用开发>应用开发
<span class=button_tally>4</span>
</a><a href=https://namejlt.github.io/tags/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/ class="post_tag button button_translucent" title=系统设计>系统设计
<span class=button_tally>4</span>
</a><a href=https://namejlt.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/ class="post_tag button button_translucent" title=数据库>数据库
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/tags/%E7%A0%94%E5%8F%91%E6%95%88%E8%83%BD/ class="post_tag button button_translucent" title=研发效能>研发效能
<span class=button_tally>2</span>
</a><a href=https://namejlt.github.io/tags/cursor/ class="post_tag button button_translucent" title=cursor>CURSOR
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/docker/ class="post_tag button button_translucent" title=docker>DOCKER
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/hugo/ class="post_tag button button_translucent" title=hugo>HUGO
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/java/ class="post_tag button button_translucent" title=java>JAVA
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/prompt/ class="post_tag button button_translucent" title=prompt>PROMPT
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/skywalking/ class="post_tag button button_translucent" title=skywalking>SKYWALKING
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E5%90%8E%E7%AB%AF/ class="post_tag button button_translucent" title=后端>后端
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/ class="post_tag button button_translucent" title=大数据>大数据
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E5%BF%83%E6%99%BA/ class="post_tag button button_translucent" title=心智>心智
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/ class="post_tag button button_translucent" title=服务治理>服务治理
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E6%B2%9F%E9%80%9A/ class="post_tag button button_translucent" title=沟通>沟通
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E6%B8%B8%E6%88%8F/ class="post_tag button button_translucent" title=游戏>游戏
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E7%B4%A2%E5%BC%95/ class="post_tag button button_translucent" title=索引>索引
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E8%90%A5%E9%94%80%E5%B7%A5%E5%85%B7/ class="post_tag button button_translucent" title=营销工具>营销工具
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/ class="post_tag button button_translucent" title=读书笔记>读书笔记
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E8%B0%83%E5%BA%A6%E7%B3%BB%E7%BB%9F/ class="post_tag button button_translucent" title=调度系统>调度系统
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E9%80%BB%E8%BE%91/ class="post_tag button button_translucent" title=逻辑>逻辑
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/ class="post_tag button button_translucent" title=阅读笔记>阅读笔记
<span class=button_tally>1</span>
</a><a href=https://namejlt.github.io/tags/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86/ class="post_tag button button_translucent" title=项目管理>项目管理
<span class=button_tally>1</span></a></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078A3.56 3.56.0 008.766 5.383c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord"><path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527.41542 45.5603.39851 45.468.440769 45.4204.525289 44.7963 1.6353 44.105 3.0834 43.6209 4.2216c-5.4572-.817-10.8864-.817-16.2317.0C26.905 3.0581 26.1886 1.6353 25.5617.525289 25.5141.443589 25.4218.40133 25.3294.41542c-5.071.87338-9.9237 2.40318-14.4518 4.48238C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795 1.57795 18.7309-.943561 32.1443.293408 45.3914.299005 45.4562.335386 45.5182.385761 45.5576 6.45866 50.0174 12.3413 52.7249 18.1147 54.5195 18.2071 54.5477 18.305 54.5139 18.3638 54.4378 19.7295 52.5728 20.9469 50.6063 21.9907 48.5383 22.0523 48.4172 21.9935 48.2735 21.8676 48.2256 19.9366 47.4931 18.0979 46.6 16.3292 45.5858 16.1893 45.5041 16.1781 45.304 16.3068 45.2082 16.679 44.9293 17.0513 44.6391 17.4067 44.3461 17.471 44.2926 17.5606 44.2813 17.6362 44.3151c11.6196 5.3051 24.1992 5.3051 35.6817.0C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433 53.9057 44.6363 54.2779 44.9293 54.6529 45.2082 54.7816 45.304 54.7732 45.5041 54.6333 45.5858c-1.7687 1.0339-3.6074 1.9073-5.5412 2.637C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383c1.0662 2.0651 2.2836 4.0316 3.6241 5.8967C52.6519 54.5139 52.7526 54.5477 52.845 54.5195c5.8014-1.7946 11.684-4.5021 17.7569-8.9619C70.6551 45.5182 70.6887 45.459 70.6943 45.3942 72.1747 30.0791 68.2147 16.7757 60.1968 4.9823 60.1772 4.9429 60.1437 4.9147 60.1045 4.8978zM23.7259 37.3253c-3.4983.0-6.3808-3.2117-6.3808-7.156s2.8266-7.156 6.3808-7.156c3.5821.0 6.4367 3.2399 6.3807 7.156.0 3.9443-2.8266 7.156-6.3807 7.156zm23.5919.0c-3.4982.0-6.3807-3.2117-6.3807-7.156s2.8265-7.156 6.3807-7.156c3.5822.0 6.4367 3.2399 6.3808 7.156.0 3.9443-2.7986 7.156-6.3808 7.156z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" id="mastodon"><path fill="#fff" d="m15.054695 9.8859583c-.22611 1.1632697-2.02517 2.4363497-4.09138 2.6830797-1.0774504.12856-2.1382704.24673-3.2694704.19484-1.84996-.0848-3.30971-.44157-3.30971-.44157.0.1801.0111.35157.0333.51194.24051 1.82571 1.81034 1.93508 3.29737 1.98607 1.50088.0514 2.8373104-.37004 2.8373104-.37004l.0617 1.35686s-1.0498104.56374-2.9199404.66742c-1.03124.0567-2.3117-.0259-3.80308-.42069-3.23454998-.85613-3.79081998-4.304-3.87592998-7.8024197-.026-1.03871-.01-2.01815-.01-2.83732.0-3.57732 2.34385998-4.62587996 2.34385998-4.62587996 1.18184-.54277 3.20976-.77101 5.318-.7882499985409h.0518C9.8267646.01719834 11.856025.24547834 13.037775.78824834c0 0 2.34377 1.04855996 2.34377 4.62587996.0.0.0294 2.63937-.32687 4.47183"/><path fill="#000" d="m12.616925 5.6916583v4.3315297h-1.71607V5.8189683c0-.88624-.37289-1.33607-1.1187604-1.33607-.82467.0-1.23799.53361-1.23799 1.58875v2.30122h-1.70594v-2.30122c0-1.05514-.4134-1.58875-1.23808-1.58875-.74587.0-1.11876.44983-1.11876 1.33607v4.2042197h-1.71607V5.6916583c0-.88527.22541-1.58876.67817-2.10922.46689-.52047 1.07833-.78727 1.83735-.78727.87816.0 1.54317.33752 1.98288 1.01267l.42744.71655.42753-.71655c.43961-.67515 1.10463-1.01267 1.9828704-1.01267.75893.0 1.37037.2668 1.83735.78727.45268.52046.67808 1.22395.67808 2.10922"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" id="bluesky"><path d="m135.72 44.03C202.216 93.951 273.74 195.17 3e2 249.49c26.262-54.316 97.782-155.54 164.28-205.46C512.26 8.009 590-19.862 590 68.825c0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-.0174-2.9357-1.1937.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07.0-88.687 77.742-60.816 125.72-24.795z"/><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="ko-fi"><path fill="#fff" d="M4.5 9.8527H32.7947a0 0 0 010 0v19.225a9.07 9.07.0 01-9.07 9.07H13.57a9.07 9.07.0 01-9.07-9.07V9.8527a0 0 0 010 0z"/><path fill="#000" d="M12.197 25.9493l6.45 6.45 6.45-6.45a8.2 8.2.0 002.4016-5.798h0a4.5082 4.5082.0 00-4.212-4.5459 4.4262 4.4262.0 00-4.64 4.4209 4.4261 4.4261.0 00-4.64-4.4209 4.5082 4.5082.0 00-4.212 4.5459h0a8.2 8.2.0 002.4024 5.798z"/><path fill="#fff" d="M32.7947 9.8527H35.73a7.77 7.77.0 010 15.5394H32.7947"/></svg>
</symbol></svg>
<script src=https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script><script type=text/javascript src=https://namejlt.github.io/zh/js/bundle.69325906ed33af5dc7368bca8e00939b95d01580847ca88772bf66270e14fb40adff431f178da9149d66c61d7dcb12f9db4aabf2273327b03c5ddfc5424b4d5e.js integrity="sha512-aTJZBu0zr13HNovKjgCTm5XQFYCEfKiHcr9mJw4U+0Ct/0MfF42pFJ1mxh19yxL520qr8iczJ7A8Xd/FQktNXg==" crossorigin=anonymous></script></body></html>